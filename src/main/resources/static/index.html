<!doctype html>
<html ng-app='MyApp'>
<head>
<title>Todo List</title>
<script src="lib/angular.1.2.4-min.js"></script>
<script src="lib/angular-animate.js"></script>
<script src="lib/ui-bootstrap-tpls-0.10.0.min.js"></script>
<link rel="stylesheet" href="css/bootstrap.min.css">

<style>
	body{
		overflow-y: scroll;
        }
	label {
		display: inline;
	}
	input[type="checkbox"]{
		display:inline;
	}
</style>

<script>
var MyApp = angular.module('MyApp',['ngAnimate','ui.bootstrap']).controller('MainCtrl',function($scope,$http,$q,$timeout){
    $scope.init = function(){

        $scope.something = 1;
        $scope.response = 'nothingyet';
        $scope.new_list_name = 'nothingyet';
        $scope.lists = [];
        
        //$scope.word_to_swap=null;
    };
    $scope.get_whatever = function(){
        var deferred = $q.defer();
        $http.get('greeting?name=bob'+$scope.something).success(function(data){
            $scope.response = data;
            deferred.resolve();
        });
        return deferred.promise;
    };
    
    $scope.button_press = function(){
        $scope.get_whatever().then(function(){
            alert('done');
            $scope.something++;
        });
    }
    
    $scope.setup_lists = function(){
        $http.get('setup').success(function(data){
            alert("Lists Setup");
        });
    };
    
    $scope.get_lists = function(){
        $http.get('get_lists').success(function(data){
            $scope.response = data;
            $scope.lists = data;
        });
    };
    
    $scope.create_list= function(){
        $http.post('create_list',JSON.stringify({'name':$scope.new_list_name})).success(function(data){
            alert("List added " + data);
            $scope.lists.push({'id':data,'name':$scope.new_list_name});
        });
    };
    
	//CORE worker related functions
	$scope.setLoading = function(text){
		if(text){
			$scope.loading_message = text;
                        $scope.loading = true;
		}else{
                        $scope.loading = null;
			$scope.loading_message = null;
		}
	};
	$scope.init();
});
</script>
</head>
<body ng-controller='MainCtrl'>
<button ng-click='button_press()'>greeting</button>
<button ng-click='setup_lists()'>setup</button>
<button ng-click='get_lists()'>get_lists</button>
<p>
<input id='new_list_name' type='text' ng-model='new_list_name'><button ng-click='create_list()'>create_list</button>
</p>
<hr>
<p>{{response}}</p>
<div class='well'>
    <p ng-repeat='list in lists'>
        <a href='javascript:void();' ng-click='load_items(list.id);'>{{list.name}}</a>
    </p>
</div>
</body>
</html>
